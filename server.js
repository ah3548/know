var test = [{"subject":"republic","sentences":[" some nations such as indonesia and azerbaijan began as secular."," the republic of azerbaijan georgia armenia and kazakhstan are not shown on this map and excluded from the count."]},{"subject":"region","sentences":[]},{"subject":"nagorno-karabakh","sentences":["nagorno-karabakh upper karabakh artsakh արցախ ------------------------------------------------------------------------------------------------------------------------------- լեռնային ղարաբաղ armenian leṙnayin ġarabaġ ------------------------------------------------------------------------------------------------------------------------------- dağlıq qarabağ yuxarı qarabağ azerbaijani ------------------------------------------------------------------------------------------------------------------------------- нагорный карабах russian nagorniy karabakh location and extent of the former nagorno-karabakh autonomous oblast lighter color ."," nagorno-karabakh is a disputed territory internationally recognized as part of azerbaijan but most of the region is governed by the nagorno-karabakh republic a de facto independent state with armenian ethnic majority established on the basis of the nagorno-karabakh autonomous oblast of the azerbaijan soviet socialist republic."," azerbaijan has not exercised political authority over the region since the advent of the karabakh movement in ."," since the end of the nagorno-karabakh war in representatives of the governments of armenia and azerbaijan have been holding peace talks mediated by the osce minsk group on the region's disputed status."," the azerbaijani names of the region include the similar adjectives dağlıq mountainous or yuxarı upper ."," the names for the region in the various local languages all translate to mountainous karabakh or mountainous black garden armenian լեռնային ղարաբաղ transliterated leṙnayin ġarabaġ ipa lɛrnɑˈjin ʁɑɾɑˈbɑʁ azerbaijani dağlıq qarabağ дағлыг гарабағ mountainous karabakh ipa dɑɣˈlɯɣ ɡɑˈɾɑbɑɣ or yuxarı qarabağ јухары гарабағ upper karabakh ipa juxɑˈɾɯ ɡɑˈɾɑbɑɣ russian нагорный карабах transliterated nagornyy karabakh or nagornyi karabah ipa nɐˈɡornɨj kərɐˈbax the armenians living in the area often refer to nagorno-karabakh as artsakh armenian արցախ using the name of the th province of the ancient kingdom of armenia."," aftermath of the shusha massacre armenian half of shusha destroyed by azerbaijani armed forces in with the defiled armenian cathedral of the holy savior in the background."," after the russian revolution of karabakh became part of the transcaucasian democratic federative republic but this soon dissolved into separate armenian azerbaijani and georgian states."," over the next two years – there were a series of short wars between armenia and azerbaijan over several regions including karabakh."," the british command provisionally affirmed khosrov bey sultanov appointed by the azerbaijani government as the governor-general of karabakh and zangezur pending final decision by the paris peace conference."," in february the karabakh national council preliminarily agreed to azerbaijani jurisdiction while armenians elsewhere in karabakh continued guerrilla fighting never accepting the agreement."," in april while the azerbaijani army was locked in karabakh fighting local armenian forces azerbaijan was taken over by bolsheviks."," needing to placate turkey the soviet union agreed to a division under which zangezur would fall under the control of armenia while karabakh and nakhchivan would be under the control of azerbaijan."," as a result the nagorno-karabakh autonomous oblast was established within the azerbaijan ssr on july ."," accusing the azerbaijani ssr government of conducting forced azerification of the region the majority armenian population with ideological and material support from the armenian ssr started a movement to have the autonomous oblast transferred to the armenian ssr."," the oblast's borders were drawn to include armenian villages and to exclude as much as possible azerbaijani villages."," large numbers of refugees left armenia and azerbaijan as violence began against the minority populations of the respective countries."," on november direct rule in nagorno-karabakh was ended and the region was returned to azerbaijani administration."," the population at that time was percent armenian and percent azerbaijanis with russian and kurdish minorities."," on november azerbaijan abolished the status of nagorno-karabakh autonomous oblast rearranging the administrative division and bringing the territory under direct control of azerbaijan."," on december in a referendum boycotted by local azerbaijanis armenians in nagorno-karabakh approved the creation of an independent state."," a soviet proposal for enhanced autonomy for nagorno-karabakh within azerbaijan satisfied neither side and a full-scale war subsequently erupted between azerbaijan and nagorno-karabakh with the latter receiving support from armenia."," the struggle over nagorno-karabakh escalated after both armenia and azerbaijan attained independence from the soviet union in ."," in the post-soviet power vacuum military action between azerbaijan and armenia was heavily influenced by the russian military."," furthermore both the armenian and azerbaijani military employed a large number of mercenaries from ukraine and russia."," as many as one thousand afghan mujahideen participated in the fighting on azerbaijan's side."," there were also fighters from chechnya fighting on the side of azerbaijan as well heavy artillery and tanks provided to armenia by russia."," many survivors from the azerbaijani side found shelter in emergency camps set up in other parts of azerbaijan to cope with the growing number of internally displaced people due to the nagorno-karabakh war."," citation needed by may the armenians were in control of of the territory of azerbaijan."," at that stage for the first time during the conflict the azerbaijani government recognized nagorno-karabakh as a third party in the war and started direct negotiations with the karabakh authorities."," post- ceasefire further information madrid principles prague process armenian–azerbaijani negotiations nagorno-karabakh declaration astrakhan declaration and land mine situation in nagorno-karabakh the final borders of the conflict after the bishkek protocol."," armenian forces of nagorno-karabakh currently control almost percent of azerbaijan's territory outside the former nagorno-karabakh autonomous oblast while azerbaijani forces control shahumian and the eastern parts of martakert and martuni.","ilham aliyev dmitry medvedev and serzh sargsyan in moscow on november despite the ceasefire fatalities due to armed conflicts between armenian and azerbaijani soldiers continued."," on january the parliamentary assembly of the council of europe pace adopted pace resolution which condemned alleged ethnic cleansing against azerbaijanis."," on – may the th session of the council of ministers of foreign affairs of the organization of islamic conference adopted resolution № -p considering the occupation of azerbaijani territory as the aggression of armenia against azerbaijan and recognizing the actions against azerbaijani civilians as a crime against humanity and condemning the destruction of archaeological cultural and religious monuments in the occupied territories."," in the resolution oic member states condemned the occupation of azerbaijani lands by armenian forces and armenian aggression against azerbaijan alleged ethnic cleansing against the azeri population and charged armenia with the destruction of cultural monuments in the occupied azerbaijani territories ."," on march of the same year the un general assembly adopted resolution № which demands the immediate complete and unconditional withdrawal of all armenian forces from all occupied territories of the republic of azerbaijan ."," on – may the th session of the council of ministers of foreign affairs of the organization of islamic conference in dushanbe adopted another resolution condemning the aggression of armenia against azerbaijan recognizing the actions against azerbaijani civilians as a crime against humanity and condemning the destruction of archaeological cultural and religious monuments in occupied territories."," the resolution states in particular that the occupied azerbaijani regions around nagorno-karabakh must be cleared as soon as possible ."," several quantify world leaders have met with the presidents of armenia and azerbaijan over the years but efforts to maintain the ceasefire have failed."," april saw reports of renewed military activities between azerbaijani and armenian forces."," the armenian defense ministry alleged that azerbaijan launched an offensive to seize territory in the region."," at least soldiers were killed during the fighting and a mil mi- helicopter and tank were also destroyed with of the fallen soldiers belonging to the azerbaijani forces and the other belonging to the armenian forces as well as an additional armenian soldiers reportedly wounded."," the territory of modern nagorno-karabakh forms a portion of the historic region of karabakh which lies between the rivers kura and araxes and the modern armenia-azerbaijan border."," th century during the soviet times the leaders of the azerbaijan ssr tried to change demographic balance in the nagorno-karabakh autonomous region nkao by increasing the number of azerbaijani residents through opening a university with azerbaijani russian and armenian sectors and a shoe factory sending azerbaijanis from other parts of azerbaijani ssr to the nkao."," nearing the collapse of the soviet union in the nagorno-karabakh autonomous oblast had a population of armenians percent azerbaijanis percent and several thousand kurds russians greeks and assyrians."," most of the azerbaijani and kurdish populations fled the region during the heaviest years of fighting in the war from to ."," in officials from yap submitted a letter to osce which included the statement the osce fact-finding mission report released last year also found that some armenians have been illegally settled on azerbaijan's occupied territories."," however the osce report released in march estimates the population of territories controlled by ethnic armenians adjacent to the breakaway azerbaijani region of nagorno-karabakh to be and states there has been no significant growth in the population since ."," transport locationicaofaaiataairport namecoordinatesstepanakertub stepanakert airport ′ ″n ′ ″e n e stepanakert air base during rule of the soviet union the yevlax-ağdam-xankəndi stepanakert line connected the nagorno-karabakh autonomous region with the main part of azerbaijan."," currently the azerbaijani trains only travel to horadiz."," the railway at the nakhchivan autonomous republic still operates but it is separated from the main azerbaijani lines and only has connection to iran."," general assembly adopts resolution reaffirming territorial integrity of azerbaijan demanding withdrawal of all armenian forces ."," georgia armenia and azerbaijan."," encyclopædia britannica azerbaijan ."," the azerbaijani turks power and identity under russian rule."," black garden armenia and azerbaijan through peace and war."," communal violence and human rights by early full-scale fighting broke out between nagorno-karabakh armenians and azerbaijani authorities."," because witnessed unrelenting karabakh armenian offensives against the azerbaijani provinces surrounding nagorno-karabakh..."," since late the conflict has also clearly become internationalized in addition to azerbaijani and karabakh armenian forces troops from the republic of armenia participate on the karabakh side in fighting inside azerbaijan and in nagorno-karabakh."," human rights developments in the conflict grew far more lethal as both sides—the azerbaijani national army and free-lance militias fighting along with it and ethnic armenians and mercenaries fighting in the popular liberation army of artsakh—began."," azerbaijan's objective advantage in terms of human and economic potential has so far been offset by the superior fighting skills and discipline of nagorno-karabakh's forces."," after a series of offensives retreats and counteroffensives nagorno-karabakh now controls a sizable portion of azerbaijan proper ..."," by giving karabakh lands to azerbaijan conflict would have ended in ' says ter-petrosian ."," ter-petrosyan on the bbc karabakh conflict could have been resolved by giving certain territories to azerbaijan ."," azerbaijan closes last of emergency camps unhcr ."," fm azerbaijan welcomes resolution 'need for eu strategy for south caucasus' adopted by european parliament."," azerbaijan military threat to armenia."," azerbaijani party appeals to osce about armenian resettlement ."," airports in azerbaijan ."," v t e territorial disputes in western asiaparties involved shown in parentheses after each entryland david gareja monastery complex georgia azerbaijan disputed areas of north iraq iraq iraqi kurdistan western golan israel syria hatay turkey syria nagorno-karabakh armenia azerbaijan nkr northern cyprus republic of cyprus turkish republic of northern cyprus saudi–iraqi neutral zone iraq saudi arabia shebaa farms israel lebanon syria judea and samaria area israel palestine islands waters abu musa greater and lesser tunbs iran united arab emirates fasht ad dibal qit'at jaradeh qatar bahrain imia kardak greece turkey khuriya muriya islands oman yemen divided among multiple claimants."]},{"subject":"country","sentences":[]},{"subject":"human","sentences":[]},{"subject":"high","sentences":[]},{"subject":"development","sentences":[]},{"subject":"rights","sentences":[]}];


var express = require('express'),
    wordnet = require('wordnet'),
    know = require('./index'),
    server = require('websocket').server,
    http = require('http'),
    winston = require('winston');

winston.add(winston.transports.File, { filename: 'know.log' });
winston.remove(winston.transports.Console);

/*var app = express();

app.all('/', function(req, res, next) {
    res.header("Access-Control-Allow-Origin", "*");
    res.header("Access-Control-Allow-Headers", "X-Requested-With");
    next();
});

app.get('/', function (req, res) {

    res.send(JSON.stringify(test));
});

app.listen(3000, function () {
    console.log('Example app listening on port 3000!')
});*/

var socket = new server({
    httpServer: http.createServer().listen(19909)
   
});

var connection = null;
socket.on('request', function(request) {
    connection = request.accept(null, request.origin);
    connection.on('message', function(message) {
        message = JSON.parse(message.utf8Data);
        winston.log("info", message.subject + ": " + message.thesis);
        know.ledge(message.subject, message.thesis)
            .then( (result) => {
                    connection.send(JSON.stringify(result));
                }
            );
    });
});
